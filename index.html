<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Панорама v2</title>
    <!-- Версия 2.1 - кэш сломан -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css?v=2.1"/>
    <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js?v=2.1"></script>
    <style>
        * { margin: 0; padding: 0; }
        html, body { height: 100%; overflow: hidden; background: #000; }
        #panorama { width: 100%; height: 100%; }
    </style>
</head>
<body>
    <div id="panorama"></div>
    <script>
        const panoramaPath = new URLSearchParams(location.search).get('panorama') || 'IMG_20181020_183652_00_012.jpg';
        
        const viewer = pannellum.viewer('panorama', {
            type: 'equirectangular',
            panorama: panoramaPath,
            autoLoad: true,
            showControls: false,
            showZoomCtrl: false,
            mouseZoom: false,
            default: { yaw: -30, pitch: -10, hfov: 75 },
            hfov: 75, minHfov: 75, maxHfov: 75,
            pitchLimits: [-45, 90]
        });
        
        // Жесткое ограничение каждые 10мс
        setInterval(() => {
            const state = viewer.getState();
            if (state.pitch < -45) viewer.setPitch(-45);
        }, 10);
    </script>
</body>
</html>
