<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>3D Панорама v5</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css?v=5">
    <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js?v=5"></script>
    <style>
        * { margin: 0; padding: 0; }
        html, body { height: 100vh; overflow: hidden; background: black; }
        #panorama { width: 100%; height: 100vh; }
    </style>
</head>
<body>
    <div id="panorama"></div>
    <script>
        const cacheBuster = '?v=' + Date.now();
        const panoramaPath = new URLSearchParams(window.location.search).get('panorama') || 
            'IMG_20181020_183652_00_012.jpg' + cacheBuster;
        
        const config = {
            type: 'equirectangular',
            panorama: panoramaPath,
            autoLoad: true,
            showControls: false,
            showZoomCtrl: false,
            mouseZoom: false,
            
            // 75° АНТИЗУМИРОВАНИЕ (3 уровня защиты)
            default: {
                yaw: -30,
                pitch: -10,
                hfov: 75
            },
            hfov: 75,
            minHfov: 75,
            maxHfov: 75,
            
            // ОГРАНИЧЕНИЕ ВНИЗ -75° (больше штатив скрыт)
            minPitch: -75,
            maxPitch: 90,
            compass: false
        };
        
        const viewer = pannellum.viewer('panorama', config);
        
        // ЖЁСТКИЙ АНТИЗУМ каждые 100мс
        setInterval(() => {
            viewer.setHfov(75);
        }, 100);
        
        // ЖЁСТКОЕ ограничение вниз каждые 50мс
        setInterval(() => {
            const state = viewer.getState();
            if (state.pitch < -75) {
                viewer.setPitch(-75);
            }
        }, 50);
    </script>
</body>
</html>
